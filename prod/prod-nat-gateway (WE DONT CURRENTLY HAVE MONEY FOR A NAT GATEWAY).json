{
  "AWSTemplateFormatVersion" : "2010-09-09",
  "Description" : "Prod Network NAT Gateway Stack",

  "Resources" : {

        "ProdNatGatewayA" : {
            "Type" : "AWS::EC2::NatGateway",
            "Properties" : {
                "AllocationId" : { "Fn::GetAtt" : ["ProdElasticIpNatgatewayA", "AllocationId"]},
                "SubnetId" : { "Fn::ImportValue" : {"Fn::Sub" : "prod-network-ProdServerSubnetA"}},
                "Tags" : [ {"Key" : "Name", "Value" : "Prod NAT Gateway A" } ]
            }
        },

        "ProdNatGatewayB" : {
            "Type" : "AWS::EC2::NatGateway",
            "Properties" : {
                "AllocationId" : { "Fn::GetAtt" : ["ProdElasticIpNatgatewayB", "AllocationId"]},
                "SubnetId" : { "Fn::ImportValue" : {"Fn::Sub" : "prod-network-ProdServerSubnetB"}},
                "Tags" : [ {"Key" : "Name", "Value" : "Prod NAT Gateway B" } ]
            }
        },

        "ProdElasticIpNatgatewayA" : {
            "Type" : "AWS::EC2::EIP",
            "Properties" : {
                "Domain" : "VPC"
            }
        },

        "ProdElasticIpNatgatewayB" : {
            "Type" : "AWS::EC2::EIP",
            "Properties" : {
                "Domain" : "VPC"
            }
        },

        "ProdNatRouteA" : {
            "Type" : "AWS::EC2::Route",
            "Properties" : {
                "RouteTableId" : { "Fn::ImportValue" : {"Fn::Sub" : "prod-route-table-ProdDataARouteTable"} },
                "DestinationCidrBlock" : "0.0.0.0/0",
                "NatGatewayId" : { "Ref" : "ProdNatGatewayA" }
            }
        },

        "ProdNatRouteB" : {
            "Type" : "AWS::EC2::Route",
            "Properties" : {
                "RouteTableId" : { "Fn::ImportValue" : {"Fn::Sub" : "prod-route-table-ProdDataBRouteTable"} },
                "DestinationCidrBlock" : "0.0.0.0/0",
                "NatGatewayId" : { "Ref" : "ProdNatGatewayB" }
            }
        }

   },

   "Outputs" : {
        "OutputProdNatGatewayA" : {
            "Description" : "Output Prod Nat Gateway A",
            "Value" :  { "Ref" : "ProdNatGatewayA" },
            "Export" : { "Name" : {"Fn::Sub": "${AWS::StackName}-ProdNatGatewayA" }}
        },

        "OutputProdNatGatewayB" : {
            "Description" : "Output Prod Nat Gateway B",
            "Value" :  { "Ref" : "ProdNatGatewayB" },
            "Export" : { "Name" : {"Fn::Sub": "${AWS::StackName}-ProdNatGatewayB" }}
        }
    }

}
